events {
    worker_connections 1024;
}

stream {
    upstream tcp_backend {
        server tcp-service:8080;
    }

    # TCP server configuration
    server {
        listen 8080;
        proxy_pass tcp_backend;
        proxy_connect_timeout 30s;
        proxy_timeout 1800s;
        proxy_buffer_size 128k;
        proxy_buffers 4 256k;
        proxy_busy_buffers_size 256k;

        # Logging
        access_log /var/log/nginx/tcp_access.log combined buffer=512k flush=1m;
        error_log /var/log/nginx/tcp_error.log warn;
    }
}

http {
    server {
        listen 80;
        server_name _;

        # Health check endpoint
        location /health {
            access_log off;
            return 200 'healthy\n';
        }
    }
} 